<!-- OSSEC Win32 Agent Configuration.
  -  This file is compost of 3 main sections:
  -    - Client config - Settings to connect to the OSSEC server. 
  -    - Localfile     - Files/Event logs to monitor.
  -    - syscheck      - System file/Registry entries to monitor.
  -->

<!-- READ ME FIRST. If you are configuring OSSEC for the first time, 
  -  try to use the "Manage_Agent" tool. Go to control panel->OSSEC Agent
  -  to execute it.
  -
  -  First, change the server-ip from "a.b.c.d" to the real IP of your server.
  -  Second, and optionally, change the settings of the files you want 
  -          to monitor. Look at our Manual and FAQ for more information.
  -  Third, start the Agent and enjoy.
  -->


<ossec_config>

  <client>
    <!-- IP address of the Ossec HIDS server. -->
    <server-ip>a.b.c.d</server-ip>
  </client>


  <!-- One entry for each file/Event log to monitor. -->
  <localfile>
    <location>Application</location>
    <log_format>eventlog</log_format>
  </localfile>

  <localfile>
    <location>Security</location>
    <log_format>eventlog</log_format>
  </localfile>

  <localfile>
    <location>System</location>
    <log_format>eventlog</log_format>
  </localfile>


  <!-- Rootcheck - Policy monitor config -->
  <rootcheck>
    <windows_audit>./shared/win_audit_rcl.txt</windows_audit>
    <windows_apps>./shared/win_applications_rcl.txt</windows_apps>
    <windows_malware>./shared/win_malware_rcl.txt</windows_malware>
  </rootcheck>  


   <!-- Syscheck - Integrity Checking config. -->
  <syscheck>
  
    <!-- Default frequency, every 18 hours. It doesn't need to be higher
      -  on most systems and one a day should be enough.
      -->
    <frequency>64800</frequency>

    <!-- By default it is disabled. In the Install you must choose
      -  to enable it.
      -->
    <disabled>yes</disabled>  
    
    <!-- Default files to be monitored - system32 only. -->
    <directories check_all="yes">%WINDIR%/system32</directories>

    <!-- Default files to be ignored. -->
    <ignore>%WINDIR%/System32/LogFiles</ignore>
    <ignore>%WINDIR%/system32/wbem/Logs</ignore>
    <ignore>%WINDIR%/system32/config</ignore>
    <ignore>%WINDIR%/system32/CatRoot</ignore>
    <ignore>%WINDIR%/system32/wbem/Repository</ignore>
    <ignore>%WINDIR%/system32/dllcache</ignore>
    <ignore>%WINDIR%/system32/inetsrv/History</ignore>
    <ignore>%WINDIR%/system32/winevt/Logs</ignore>
    <ignore>%WINDIR%/system32/spool</ignore>
    <ignore type="sregex">.log$|.htm$|.jpg$|.png$|.chm$|.pnf$|.evtx$</ignore>


    <!-- Windows registry entries to monitor. -->
    <windows_registry>HKEY_LOCAL_MACHINE\Software\Policies</windows_registry>
    <windows_registry>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion</windows_registry>
    <windows_registry>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion</windows_registry>
    <windows_registry>HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer</windows_registry>
    <windows_registry>HKEY_LOCAL_MACHINE\Software\Classes</windows_registry>
    <windows_registry>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control</windows_registry>
    <windows_registry>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services</windows_registry>
    <windows_registry>HKEY_LOCAL_MACHINE\Security</windows_registry>

    <!-- Windows registry entries to ignore. -->
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Group Policy\State</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\WindowsUpdate</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Cache</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\ProfileList</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Prefetcher</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\Interface</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\TypeLib</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\MIME</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\Software</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\CLSID</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Security\Policy\Secrets</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\Security\SAM\Domains\Account\Users</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Watchdog</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\MediaCategories</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Windows</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\hivelist</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\ServiceCurrent</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</registry_ignore>    
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Eventlog</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\RemoteAccess\Performance</registry_ignore>
    <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient</registry_ignore>    
    <registry_ignore type="sregex">\Enum$</registry_ignore>
  </syscheck>    

</ossec_config>


<!-- END of Default Configuration. -->

