/*
 * Wazuh databaseFeedManager tests.
 * Copyright (C) 2015, Wazuh Inc.
 * September 19, 2023.
 *
 * This program is free software; you can redistribute it
 * and/or modify it under the terms of the GNU General Public
 * License (version 2) as published by the FSF - Free Software
 * Foundation.
 */

#ifndef _DATABASE_FEED_MANAGER_TESTS_HPP
#define _DATABASE_FEED_MANAGER_TESTS_HPP

#include "databaseFeedManager.hpp"
#include "gmock/gmock.h"
#include "gtest/gtest.h"
#include <filesystem>

constexpr auto DESCRIPTION_DATABASE_DIR {"queue/vd"};

const std::string vulnerabilityCandidateExample {
    "[{\"cveId\":\"CVE-1999-1234\",\"defaultStatus\":\"unaffected\",\"platforms\":[\"ubuntu\"],"
    "\"versions\":[{\"status\":\"affected\",\"version\":\"1.0.2\"},{\"lessThan\":\"1.1.5-1\",\"status\":\"affected\","
    "\"version\":\"0\",\"versionType\":\"deb\"},"
    "{\"lessThan\":\"*\",\"status\":\"affected\",\"version\":\"0\",\"versionType\":\"custom\"}]},{\"cveId\":\"CVE-1999-"
    "1235\",\"defaultStatus\":\"unaffected\","
    "\"platforms\":[\"ubuntu\"],\"versions\":[{\"status\":\"affected\",\"version\":\"1.0.2\"},{\"lessThan\":\"1.1.5-"
    "1\",\"status\":\"affected\",\"version\":\"0\","
    "\"versionType\":\"deb\"},{\"lessThan\":\"*\",\"status\":\"affected\",\"version\":\"0\",\"versionType\":\"custom\"}"
    "]}]"};

const std::string packageName {"libmagic-mgc"};

const std::string flatbufferSchema {"scanVulnerabilityCandidate.fbs"};

/**
 * @brief DatabaseFeedManagerTest class
 *
 */
class DatabaseFeedManagerTests : public ::testing::Test
{
protected:
    /**
     * @brief Construct a new Database Feed Manager Tests object
     *
     */
    DatabaseFeedManagerTests() = default;

    /**
     * @brief Destroy the Database Feed Manager Tests object
     *
     */
    virtual ~DatabaseFeedManagerTests() = default;

    /**
     * @brief SetUp.
     *
     */
    void SetUp() override;

    /**
     * @brief TearDown.
     *
     */
    void TearDown() override;
};

#endif // _DATABASE_FEED_MANAGER_TESTS_HPP
