test_name: GET /overview/agents

marks:
  - usefixtures:
    - base_tests

includes:
 - !include common.yaml

stages:
   # Authentication stage
 - type: ref
   id: login_get_token

 - name: Get full agents overview
   request:
     url: "{protocol:s}://{host:s}:{port:d}/overview/agents"
     method: GET
     headers:
       Authorization: "Bearer {test_login_token}"
   response:
     status_code: 200
     body:
       data:
         agent_os:
           - count: 3
             os:
               name: !anystr
               platform: !anystr
               version: !anystr
           - count: 6
             os:
               name: !anystr
               platform: !anystr
               version: !anystr
           - count: 2
             os:
               name: !anystr
               platform: !anystr
               version: !anystr
           - count: 2
         agent_status:
           active: 9
           disconnected: 2
           never_connected: 2
           pending: 0
           total: 13
         agent_version:
           - count: 1
             version: !anystr
           - count: 8
             version: !anystr
           - count: 2
             version: !anystr
           - count: 2
         groups:
           - configSum: !anystr
             count: !anyint
             mergedSum: !anystr
             name: !anystr
           - configSum: !anystr
             count: !anyint
             mergedSum: !anystr
             name: !anystr
           - configSum: !anystr
             count: !anyint
             mergedSum: !anystr
             name: !anystr
           - configSum: !anystr
             count: !anyint
             mergedSum: !anystr
             name: !anystr
         last_registered_agent:
           - configSum: !anystr
             dateAdd: !anystr
             group: !anything
             id: !anystr
             ip: !anystr
             lastKeepAlive: !anystr
             manager: !anystr
             mergedSum: !anystr
             name: !anystr
             node_name: !anystr
             os:
               arch: !anystr
               codename: !anystr
               major: !anystr
               minor: !anystr
               name: !anystr
               platform: !anystr
               uname: !anystr
               version: !anystr
             registerIP: any
             status: active
             version: !anystr
         nodes:
           - count: !anyint
             node_name: !anything
           - count: !anyint
             node_name: !anything
           - count: !anyint
             node_name: !anything
           - count: !anyint
             node_name: !anything
