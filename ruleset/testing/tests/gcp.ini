[GCP VPC Firewall: ALLOW rule triggered]
log 1 pass = {"integration":"gcp","gcp":{"insertId":"6dxcl6g15v9cee","jsonPayload":{"connection":{"dest_ip":"10.142.0.2","dest_port":22,"protocol":6,"src_ip":"XX.XX.XX.XX","src_port":43710},"disposition":"ALLOWED","instance":{"project_id":"wazuh-dev-XXXXXX","region":"us-east1","vm_name":"framework-vpc-flow-test-instance","zone":"us-east1-b"},"rule_details":{"action":"ALLOW","direction":"INGRESS","ip_port_info":[{"ip_protocol":"TCP","port_range":["22"]}],"priority":65534,"reference":"network:default/firewall:default-allow-ssh","source_range":["0.0.0.0/0"]},"vpc":{"project_id":"wazuh-dev-XXXXXX","subnetwork_name":"default","vpc_name":"default"}},"logName":"projects/wazuh-dev-XXXXXX/logs/compute.googleapis.com%2Ffirewall","receiveTimestamp":"2021-06-04T13:27:43.45097863Z","resource":{"labels":{"location":"us-east1-b","project_id":"wazuh-dev-XXXXXX","subnetwork_id":"6133410668509430049","subnetwork_name":"default"},"type":"gce_subnetwork"},"timestamp":"2021-06-04T13:27:35.794717819Z"}}

rule = 65049
alert = 3
decoder = json


[GCP VPC Flow rules grouped]
log 1 pass = {"integration":"gcp","gcp":{"insertId":"g3n55zfjeyg2i","jsonPayload":{"bytes_sent":"8","connection":{"dest_ip":"ff02::2","protocol":58,"src_ip":"XXXXXXXXXXXXXX"},"dest_location":{},"end_time":"2021-06-04T11:18:46.770486824Z","packets_sent":"1","reporter":"SRC","src_instance":{"project_id":"wazuh-dev-XXXXXX","region":"us-east1","vm_name":"framework-vpc-flow-test-instance","zone":"us-east1-b"},"src_vpc":{"project_id":"wazuh-dev-XXXXXX","subnetwork_name":"default","vpc_name":"default"},"start_time":"2021-06-04T11:18:46.770486824Z"},"logName":"projects/wazuh-dev-XXXXXX/logs/compute.googleapis.com%2Fvpc_flows","receiveTimestamp":"2021-06-04T11:19:10.440812789Z","resource":{"labels":{"location":"us-east1-b","project_id":"wazuh-dev-XXXXXX","subnetwork_id":"6133410668509430049","subnetwork_name":"default"},"type":"gce_subnetwork"},"timestamp":"2021-06-04T11:19:10.440812789Z"}}

rule = 65050
alert = 2
decoder = json


[GCP VPC Firewall: DENY rule triggered]
log 1 pass = {"integration":"gcp","gcp":{"insertId":"6dxcl6g15v9cee","jsonPayload":{"connection":{"dest_ip":"10.142.0.2","dest_port":22,"protocol":6,"src_ip":"XX.XX.XX.XX","src_port":43710},"disposition":"DENIED","instance":{"project_id":"wazuh-dev-XXXXXX","region":"us-east1","vm_name":"framework-vpc-flow-test-instance","zone":"us-east1-b"},"rule_details":{"action":"DENY","direction":"INGRESS","ip_port_info":[{"ip_protocol":"TCP","port_range":["22"]}],"priority":65534,"reference":"network:default/firewall:default-deny-ssh","source_range":["0.0.0.0/0"]},"vpc":{"project_id":"wazuh-dev-XXXXXX","subnetwork_name":"default","vpc_name":"default"}},"logName":"projects/wazuh-dev-XXXXXX/logs/compute.googleapis.com%2Ffirewall","receiveTimestamp":"2021-06-04T13:27:43.45097863Z","resource":{"labels":{"location":"us-east1-b","project_id":"wazuh-dev-XXXXXX","subnetwork_id":"6133410668509430049","subnetwork_name":"default"},"type":"gce_subnetwork"},"timestamp":"2021-06-04T13:27:35.794717819Z"}}

rule = 65048
alert = 5
decoder = json

; [GCP Generic DEFAULT]

; rule = 65039
; alert = 0
; decoder = json

[GCP Generic INFO]
log 1 pass = {"gcp":{"severity":"INFO","logName":"projects/wazuh-dev-258815/logs/cloudaudit.googleapis.com%2Fdata_access","resource":{"type":"audited_resource","labels":{"method":"google.monitoring.v3.MetricService.ListTimeSeries","project_id":"wazuh-dev-258815","service":"monitoring.googleapis.com"}},"protoPayload":{"requestMetadata":{"requestAttributes":{"time":"2021-06-11T09:35:18.077583788Z"},"callerSuppliedUserAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36,gzip(gfe)","callerIp":"80.39.210.176"},"request":{"filter":"metric.type=\"pubsub.googleapis.com/topic/send_message_operation_count\" AND resource.labels.project_id=\"wazuh-dev-258815\" AND resource.labels.topic_id=\"wazuh-gcloud-blog-topic\" AND resource.type=\"pubsub_topic\"","@type":"type.googleapis.com/google.monitoring.v3.ListTimeSeriesRequest","name":"projects/wazuh-dev-258815"},"authenticationInfo":{"principalEmail":"javier.bejar@wazuh.com"},"authorizationInfo":[{"resource":"769054035614","permission":"monitoring.timeSeries.list","resourceAttributes":{},"granted":true}],"@type":"type.googleapis.com/google.cloud.audit.AuditLog","numResponseItems":"1","methodName":"google.monitoring.v3.MetricService.ListTimeSeries","resourceName":"projects/wazuh-dev-258815","serviceName":"monitoring.googleapis.com"},"receiveTimestamp":"2021-06-11T09:35:18.35940193Z","insertId":"s1gmn4e7xlr1","timestamp":"2021-06-11T09:35:18.077460268Z"},"integration":"gcp"}

rule = 65040
alert = 2
decoder = json

[GCP Generic Warning]
log 1 pass = {"integration":"gcp","gcp":{"httpRequest":{"latency":"0.000864s","remoteIp":"YY.YY.YY.YY","requestMethod":"GET","requestSize":"385","requestUrl":"http://XX.XX.XX.XX/favicon.ico","responseSize":"488","status":502,"userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36"},"insertId":"1mtxf1hf2c4idk","jsonPayload":{"@type":"type.googleapis.com/google.cloud.loadbalancing.type.LoadBalancerLogEntry","statusDetails":"failed_to_pick_backend"},"logName":"projects/wazuh-dev-xxxxxx/logs/requests","receiveTimestamp":"2021-06-09T15:17:25.473538144Z","resource":{"labels":{"backend_service_name":"framework-load-balancer-backend-test","forwarding_rule_name":"framework-load-balancer-backend-test","project_id":"wazuh-dev-xxxxxx","target_proxy_name":"framework-load-balancer-test-target-proxy","url_map_name":"framework-load-balancer-test","zone":"global"},"type":"http_load_balancer"},"severity":"WARNING","spanId":"ab6c36e7fc60f24e","timestamp":"2021-06-09T15:17:24.408864Z","trace":"projects/wazuh-dev-xxxxxx/traces/68183a7cda548ce0e79207099a1fea58"}}

rule = 65041
alert = 5
decoder = json

[GCP Generic NOTICE]
log 1 pass = {"gcp":{"severity":"NOTICE","logName":"projects/wazuh-dev-258815/logs/cloudaudit.googleapis.com%2Factivity","resource":{"type":"pubsub_topic","labels":{"project_id":"wazuh-dev-258815","topic_id":"projects/wazuh-dev-258815/topics/threatintel-gcp"}},"protoPayload":{"requestMetadata":{"requestAttributes":{"time":"2021-06-10T15:07:09.68842532Z"},"callerSuppliedUserAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.101 Safari/537.36,gzip(gfe)","callerIp":"80.39.210.176"},"request":{"@type":"type.googleapis.com/google.pubsub.v1.Subscription","messageRetentionDuration":"604800s","name":"projects/wazuh-dev-258815/subscriptions/threatintel-gcp-sub","topic":"projects/wazuh-dev-258815/topics/threatintel-gcp","ackDeadlineSeconds":"10"},"authenticationInfo":{"principalSubject":"user:javier.bejar@wazuh.com","principalEmail":"javier.bejar@wazuh.com"},"authorizationInfo":[{"resource":"projects/wazuh-dev-258815/topics/threatintel-gcp","permission":"pubsub.topics.attachSubscription","resourceAttributes":{},"granted":true}],"@type":"type.googleapis.com/google.cloud.audit.AuditLog","response":{"@type":"type.googleapis.com/google.pubsub.v1.Subscription","messageRetentionDuration":"604800s","name":"projects/wazuh-dev-258815/subscriptions/threatintel-gcp-sub","topic":"projects/wazuh-dev-258815/topics/threatintel-gcp","ackDeadlineSeconds":"10"},"methodName":"google.pubsub.v1.Subscriber.CreateSubscription","resourceName":"projects/wazuh-dev-258815/topics/threatintel-gcp","serviceName":"pubsub.googleapis.com"},"receiveTimestamp":"2021-06-10T15:07:15.879792037Z","insertId":"jzee3lb9j","timestamp":"2021-06-10T15:07:09.68170948Z"},"integration":"gcp"}

; rule = 65042
; alert = 3
; decoder = json

; [GCP Generic ERROR]

; rule = 65043
; alert = 7
; decoder = json

; [GCP Generic CRITICAL]

; rule = 65044
; alert = 9
; decoder = json

; [GCP Generic ALERT]

; rule = 65045
; alert = 11
; decoder = json

; [GCP Generic EMERGENCY]

; rule = 65046
; alert = 12
; decoder = json