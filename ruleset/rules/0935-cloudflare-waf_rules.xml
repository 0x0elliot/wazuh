<group name="WAF,">

  <rule id="92500" level="0">
    <decoded_as>json</decoded_as>
    <description>WAF-prerequisite rule</description>
  </rule>

  <rule id="92501" level="0">
    <if_sid>92500</if_sid>
    <field name="WAFAction" type="pcre2">.+</field>
    <description>WAF rules</description>
  </rule>

  <rule id="92502" level="4">
    <if_sid>92501</if_sid>
    <field name="ClientRequestMethod" type="pcre2">GET</field>
    <description>WAF: GET request $(ClientRequestURI)</description>
  </rule>

  <rule id="92503" level="5">
    <if_sid>92501</if_sid>
    <field name="ClientRequestMethod" type="pcre2">POST</field>
    <description>WAF: POST request $(ClientRequestURI)</description>
  </rule>

  <rule id="92504" level="5">
    <if_sid>92501</if_sid>
    <field name="ClientRequestMethod" type="pcre2">PUT</field>
    <description>WAF: PUT request $(ClientRequestURI)</description>
    <group>hipaa_164.312.c.1</group>
  </rule>

  <rule id="92505" level="7">
    <if_sid>92501</if_sid>
    <field name="ClientRequestURI" type="pcre2">/auth/login</field>
    <description>WAF: Authentication attempt</description>
  </rule>

  <rule id="92506" level="4">
    <if_sid>92505</if_sid>
    <field name="EdgeResponseStatus" type="pcre2">200</field>
    <description>WAF: Authentication success from $(OriginIP)</description>
    <group>hipaa_164.312.d,pci_dss_8.2</group>
  </rule>

  <rule id="92507" level="7">
    <if_sid>92505</if_sid>
    <field name="EdgeResponseStatus" type="pcre2" negate="yes">200</field>
    <description>WAF: Authentication failure from $(OriginIP)</description>
    <group>hipaa_164.312.e.1,gpg13_3.3,nist_800_53_AC.7,pci_dss_8.2</group>
    <mitre>
     <id>T1102</id>
    </mitre>
  </rule>
</group>
