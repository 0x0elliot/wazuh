<group name="wazuh-api">

<rule id="400" level="0">
 <decoded_as>wazuh-api</decoded_as>
 <description>Rules for Wazuh API events</description>
</rule>

<rule id="420" level="0">
 <decoded_as>wazuh-api-block</decoded_as>
 <description>Rules for Wazuh API events</description>
 <mitre>
  <id>T1102</id>
 <mitre>
</rule>

<rule id="401" level="3">
 <if_sid>400</if_sid>
 <field name="type">INFO</field>
 <description>API informative event</description>
</rule>

<rule id="402" level="5">
 <if_sid>400</if_sid>
 <field name="type">WARNING</field>
 <description>API warning event</description>
</rule>

<rule id="403" level="8">
 <if_sid>400</if_sid>
 <field name="type">ERROR</field>
 <description>API error event</description>
</rule>

<rule id="404" level="12">
 <if_sid>400</if_sid>
 <field name="type">CRITICAL</field>
 <description>API critical error event, requires inmediate atention</description>
</rule>

<rule id="421" level="3">
 <if_sid>420</if_sid>
 <field name="type">INFO</field>
 <description>API blocking informative event</description>
 <mitre>
  <id>T1102</id>
 <mitre>
</rule>

<rule id="422" level="5">
 <if_sid>420</if_sid>
 <field name="type">WARNING</field>
 <description>API blocking warning event</description>
 <mitre>
  <id>T1102</id>
 <mitre>
</rule>

<rule id="423" level="8">
 <if_sid>420</if_sid>
 <field name="type">ERROR</field>
 <description>API blocking error event</description>
 <mitre>
  <id>T1102</id>
 <mitre>
</rule>

<rule id="424" level="12">
 <if_sid>420</if_sid>
 <field name="type">CRITICAL</field>
 <description>API blocking critical error event, requires inmediate atention</description>
 <mitre>
  <id>T1102</id>
 <mitre>
</rule>

<rule id="405" level="7">
 <if_sid>400</if_sid>
 <field name="http_status_code" negate="yes">200</field>
 <description>API's response code returned error</description>
</rule>

<rule id="410" level="4">
 <if_sid>405</if_sid>
 <field name="http_status_code">400</field>
 <description>API's response code returned error: Bad request.</description>
</rule>

<rule id="411" level="6">
 <if_sid>405</if_sid>
 <field name="http_status_code">401</field>
 <description>API's response code returned error: Unauthorized.</description>
 <mitre>
  <id>T1102</id>
 <mitre>
</rule>

<rule id="412" level="7">
 <if_sid>405</if_sid>
 <field name="http_status_code">403</field>
 <description>API's response code returned error: Permission denied.</description>
</rule>

<rule id="413" level="4">
 <if_sid>405</if_sid>
 <field name="http_status_code">404</field>
 <description>API's response code returned error: Resource not found.</description>
</rule>

<rule id="414" level="4">
 <if_sid>405</if_sid>
 <field name="http_status_code">405</field>
 <description>API's response code returned error: Invalid HTTP method.</description>
</rule>

<rule id="415" level="4">
 <if_sid>405</if_sid>
 <field name="http_status_code">406</field>
 <description>API's response code returned error: Invalid content-type</description>
</rule>

<rule id="416" level="4">
 <if_sid>405</if_sid>
 <field name="http_status_code">413</field>
 <description>API's response code returned: Maximum request body size exceeded</description>
</rule>

<rule id="417" level="7">
 <if_sid>405</if_sid>
 <field name="http_status_code">429</field>
 <description>API's response code: Max number of requests per minute reached</description>
</rule>

<rule id="418" level="4">
 <if_sid>405</if_sid>
 <field name="http_status_code">500</field>
 <description>API's response code: Internal error</description>
</rule>

<rule id="406" level="4">
 <if_sid>400</if_sid>
 <field name="method">GET</field>
 <description>API's GET protocol event, data were received</description>
</rule>

<rule id="407" level="6">
 <if_sid>400</if_sid>
 <field name="method">PUT</field>
 <description>API's PUT protocol event, data were saved</description>
</rule>

<rule id="408" level="8">
 <if_sid>400</if_sid>
 <field name="method">DELETE</field>
 <description>API's DELETE protocol event, data were deleted</description>
</rule>

<rule id="409" level="6">
 <if_sid>400</if_sid>
 <field name="method">POST</field>
 <description>API's POST protocol event, data were transfered</description>
</rule>

<rule id="425" level="0">
 <if_sid>400</if_sid>
 <field name="uri">/security/user/authenticate</field>
 <description>Authentication attempt</description>
</rule>

<rule id="426" level="3">
 <if_sid>425</if_sid>
 <field name="http_status_code">200</field>
 <description>Authentication success to the API</description>
</rule>

<rule id="427" level="7">
 <if_sid>425</if_sid>
 <field name="http_status_code" negate="yes">200</field>
 <description>API authentication failure</description>
 <mitre>
  <id>T1102</id>
 <mitre>
</rule>


</group>
