<!--
  -  F5 Networks BIG-IP LTM rules
  -  Created by Wazuh, Inc.
  -  Author: Juan Ricci, Javier Bejar, Fabricio Brunetti
  -  Copyright (C) 2015-2021, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<group name="f5_bigip,">

     <!-- F5 BigIP LTM grouped rules -->
    <rule id="65260" level="0">
        <decoded_as>f5_bigip_ltm</decoded_as>
        <description>F5 Networks BigIP LTM events.</description>
    </rule>

    <rule id="65261" level="9">
        <if_sid>65260</if_sid>
        <field name="event.code">01010251</field>
        <description>Virtual server is during high-demand traffic event or under Denial of Service (DoS) attack</description>
        <mitre>
            <id>T1498</id>
        </mitre>
    </rule>

    <rule id="65262" level="9">
        <if_sid>65260</if_sid>
        <field name="event.code">01010343</field>
        <description>Platform entered software SYN cookie protection mode. The system has detected a SYN flood attack.</description>
        <mitre>
            <id>T1498</id>
        </mitre>
    </rule>

    <rule id="65263" level="9">
        <if_sid>65260</if_sid>
        <field name="event.code">011e0001</field>
        <description>Stopped throttling traffic likely generated by a DoS attack</description>
        <mitre>
            <id>T1498</id>
        </mitre>
    </rule>

    <rule id="65264" level="9">
        <if_sid>65260</if_sid>
        <field name="event.code">01010038</field>
        <description>SYN cookie threshold is reached. This might be due to a normal spike in traffic or an attack.</description>
        <mitre>
            <id>T1498</id>
        </mitre>
    </rule>

    <rule id="65265" level="9">
        <if_sid>65260</if_sid>
        <field name="event.code">01010240</field>
        <description>Detected a syncookie DOS attack. Activated hardware syncookie protection mode on the HSB.</description>
        <mitre>
            <id>T1498</id>
        </mitre>
    </rule>

    <rule id="65266" level="9">
        <if_sid>65260</if_sid>
        <field name="event.code">01010329</field>
        <description>Ongoing DDos attack.</description>
        <mitre>
            <id>T1498</id>
        </mitre>
    </rule>

    <!-- General rules by type, defined last to catch all -->
    <rule id="65267" level="3">
        <if_sid>65260</if_sid>
        <field name="event.type">notice</field>
        <description>F5 BigIP LTM: Notice message detected.</description>
    </rule>

    <rule id="65268" level="7">
        <if_sid>65260</if_sid>
        <field name="event.type">warning</field>
        <description>F5 BigIP LTM: Warning message detected.</description>
    </rule>

    <rule id="65269" level="7">
        <if_sid>65260</if_sid>
        <field name="event.type">alert</field>
        <description>F5 BigIP LTM: Alert message detected.</description>
    </rule>
</group>
