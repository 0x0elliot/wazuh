<!-- Sample log
2021/04/20 16:00:35 INFO: wazuh 127.0.0.1 "PUT /agents/group" with parameters {"group_id": "group1", "agents_list": "629,650,654,682"} and body {} done in 0.075s: 200
-->

<decoder name="wazuh-api">
   <prematch type="pcre2">\s\d+:\d+:\d+\s\w+:\s\w+\s\d+.\d+.\d+.\d+</prematch>
</decoder>

<decoder name="wazuh-api-block">
  <prematch type="pcre2">^\d+\/\d+\/\d+\s\d+:\d+:\d+\s\w+:.+:\s\d+.\d+.\d+.\d+.\d+</prematch>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">^(\d+\/\d+\/\d+\s\d+:\d+:\d+)</regex>
  <order>timestamp</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">^\d+\/\d+\/\d+\s\d+:\d+:\d+\s\w+:\s(\w+)</regex>
  <order>user</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">\s(\w+):\s\w+</regex>
  <order>type</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">(\d+.\d+.\d+.\d+)</regex>
  <order>srcip</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">"(\w+)\s(.+)"\swith\sparameters\s\{(.+)\}\sand</regex>
  <order>method,uri,parameters</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">"(.+)"\swith\sparameters\s\{.+\}\sand</regex>
  <order>endpoint</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">and\sbody\s{(.+)}</regex>
  <order>body</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api</parent>
  <regex type="pcre2">s:\s(\d+)</regex>
  <order>http_status_code</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api-block</parent>
  <regex type="pcre2">^(\d+\/\d+\/\d+\s\d+:\d+:\d+)</regex>
  <order>timestamp</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api-block</parent>
  <regex type="pcre2">\s(\w+):\s\w+</regex>
  <order>type</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api-block</parent>
  <regex type="pcre2">:\s(\d+.\d+.\d+.\d+)</regex>
  <order>srcip</order>
</decoder>

<decoder name="wazuh-api-son">
  <parent>wazuh-api-block</parent>
  <regex type="pcre2">:\s(.+):\s</regex>
  <order>message</order>
</decoder>
