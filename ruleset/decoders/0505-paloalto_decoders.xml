<!--
  -  PaloAlto v9.0 decoders
  -  Created by Wazuh, Inc.
  -  Copyright (C) 2015-2021, Wazuh Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->


<!-- Generic paloalto decoder -->
<decoder name="paloalto">
  <prematch type="pcre2">^[^,]*,\d+\/\d+\/\d+\s\d+:\d+:\d+,\d+,\w+,</prematch>
</decoder>

<!-- paloalto system decoders -->
<!-- Supported versions
  - 8.X-9.X: FUTURE_USE, Receive Time, Serial Number, Type, Content/Threat Type, FUTURE_USE, Generated Time, Virtual System, Event ID, Object, FUTURE_USE, FUTURE_USE, Module, Severity, Description, Sequence Number, Action Flags, Device Group Hierarchy Level 1, Device Group Hierarchy Level 2, Device Group Hierarchy Level 3, Device Group Hierarchy Level 4, Virtual System Name, Device Name

  - 10.X: FUTURE_USE, Receive Time, Serial Number, Type, Content/Threat Type, FUTURE_USE, Generated Time, Virtual System, Event ID, Object, FUTURE_USE, FUTURE_USE, Module, Severity, Description, Sequence Number, Action Flags, Device Group Hierarchy Level 1, Device Group Hierarchy Level 2, Device Group Hierarchy Level 3, Device Group Hierarchy Level 4, Virtual System Name, Device Name, FUTURE_USE, FUTURE_USE, High Resolution Timestamp
-->
<decoder name="paloalto-system-fields">
  <parent>paloalto</parent>
  <prematch type="pcre2">^[^,]*,\d+\/\d+\/\d+\s\d+:\d+:\d+,\d+,SYSTEM,</prematch>
  <regex type="pcre2">^[^,]*,(\d+\/\d+\/\d+\s\d+:\d+:\d+),(\d+),(SYSTEM),</regex>
  <order>receive_time, serial_number, type</order>
</decoder>

<decoder name="paloalto-system-fields">
  <parent>paloalto</parent>
  <regex type="pcre2" offset="after_regex">^(\w+),[^,]*,(\d+\/\d+\/\d+\s\d+:\d+:\d+),([^,]*),([^,]*),([^,]*),</regex>
  <order>content_type, generated_time, virtual_system, event_id, object</order>
</decoder>

<decoder name="paloalto-system-fields">
  <parent>paloalto</parent>
  <regex type="pcre2" offset="after_regex">^[^,]*,[^,]*,(\w*),(\w*),(?:"([^"]*)")?,(\d*),([^,]*),</regex>
  <order>module, severity, description, sequence_number, action_flags</order>
</decoder>

<decoder name="paloalto-system-fields">
  <parent>paloalto</parent>
  <regex type="pcre2" offset="after_regex">^([^,]*),([^,]*),([^,]*),([^,]*),([^,]*),([^,]*)</regex>
  <order>dg_hier_level_1, dg_hier_level_2, dg_hier_level_3, dg_hier_level_4, virtual_system_name, device_name</order>
</decoder>

<decoder name="paloalto-system-fields">
  <parent>paloalto</parent>
  <regex type="pcre2" offset="after_regex">^,[^,]*,[^,]*,([^,]*)</regex>
  <order>hish_resolution_timestamp</order>
</decoder>