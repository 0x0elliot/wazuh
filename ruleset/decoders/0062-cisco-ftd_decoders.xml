<!--
  -  Cisco VPN Concentrator decoders
  -  Author: Daniel Cid.
  -  Updated by Wazuh, Inc.
  -  Copyright (C) 2015-2021, Wazuh Inc.
  -  Copyright (C) 2009 Trend Micro Inc.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<!-- General decoder -->
<decoder name="cisco-ftd">
    <prematch type="pcre2">[^%]*%FTD-[0-7]-[^:\s]+[:\s].*</prematch>
    <regex type="pcre2">([^%]+)?%(FTD)-([0-7])-([^:\s]+):?\s?(.+)?</regex>
    <order>header, product.name, event.severity, event.id, message</order>
</decoder>


<!--
%FTD-6-305012: Teardown dynamic TCP translation from WLC-LAN_inside:10.233.16.130/6890 to outside:193.17.108.1/6890 duration 0:02:32
-->
<decoder name="cisco-ftd-teardown-translation">
    <parent>cisco-ftd</parent>
    <prematch>6-305012</prematch>
    <regex type="pcre2">(\.+) from (\S+):(\S+)/(\S+) to (\S+):(\S+)/(\S+) duration (\d+:\d+:\d+)</regex>
    <order>description, src, src_ip, src_port, dst, dst_ip, dst_port, duration</order>
</decoder>





