{
  "set_role_policy": [
    {
      "params": {
        "role_id": [
          "1"
        ],
        "policy_ids": [
          "15", "14", "16"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4008": [
            "1"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "99"
        ],
        "policy_ids": [
          "15", "14", "16"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4002": [
            "99"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "10"
        ],
        "policy_ids": [
          "12", "11", "18", "15", "14"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 10,
          "name": "technical",
          "rule": {
            "MATCH": {
              "definition": "technicalRule"
            }
          },
          "policies": [{
            "id": 11,
            "name": "wazuhPolicy",
            "policy": {
              "actions": ["*:*"],
              "resources": ["*:*"],
              "effect": "allow"
            }
          }, {
            "id": 12,
            "name": "wazuh-wuiPolicy",
            "policy": {
              "actions": ["agent:create"],
              "effect": "allow",
              "resources": ["agent:id:001", "agent:id:002", "agent:id:003"]
            }
          }, {
            "id": 14,
            "name": "administratorPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "allow",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 15,
            "name": "normalPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "deny",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 18,
            "name": "policy2",
            "policy": {
              "actions": ["role:read"],
              "effect": "allow",
              "resources": ["role:id:1"]
            }
          }],
          "users": ["rbac"]
        }],
        "failed_items": {
          "4011": [
            "12", "11", "18", "15"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "11"
        ],
        "policy_ids": [
          "14", "16", "99"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 11,
          "name": "administrator_test",
          "rule": {
            "MATCH": {
              "definition": "administratorRule"
            }
          },
          "policies": [{
            "id": 14,
            "name": "administratorPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "allow",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 15,
            "name": "normalPolicy",
            "policy": {
              "actions": ["agent:update", "agent:delete"],
              "effect": "deny",
              "resources": ["agent:id:*"]
            }
          }, {
            "id": 16,
            "name": "ossecPolicy",
            "policy": {
              "actions": ["role:read"],
              "effect": "allow",
              "resources": ["role:id:*"]
            }
          }],
          "users": ["normal", "rbac"]
        }],
        "failed_items": {
          "4007": [
            "99"
          ],
          "4011": [
            "14"
          ]
        }
      }
    }
  ],
  "remove_role_policy": [
    {
      "params": {
        "role_id": [
          "1"
        ],
        "policy_ids": [
          "15", "14", "16"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4008": [
            "1"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "99"
        ],
        "policy_ids": [
          "15", "14", "16"
        ]
      },
      "result": {
        "affected_items": [],
        "failed_items": {
          "4002": [
            "99"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "10"
        ],
        "policy_ids": [
          "15", "14", "16"
        ]
      },
      "result": {
        "affected_items": [{
          "id": 10,
          "name": "technical",
          "rule": {
            "MATCH": {
              "definition": "technicalRule"
            }
          },
          "policies": [{
            "id": 11,
            "name": "wazuhPolicy",
            "policy": {
              "actions": ["*:*"],
              "resources": ["*:*"],
              "effect": "allow"
            }
          }, {
            "id": 12,
            "name": "wazuh-wuiPolicy",
            "policy": {
              "actions": ["agent:create"],
              "effect": "allow",
              "resources": ["agent:id:001", "agent:id:002", "agent:id:003"]
            }
          }, {
            "id": 18,
            "name": "policy2",
            "policy": {
              "actions": ["role:read"],
              "effect": "allow",
              "resources": ["role:id:1"]
            }
          }],
          "users": ["rbac"]
        }],
        "failed_items": {
          "4010": [
            "14", "16"
          ]
        }
      }
    },
    {
      "params": {
        "role_id": [
          "13"
        ],
        "policy_ids": [
          "12", "15", "16", "26"
        ]
      },
      "result": {
        "affected_items": [
          {
            "id": 13,
            "name": "ossec",
            "policies": [
              {
                "id": 11,
                "name": "wazuhPolicy",
                "policy": {
                  "actions": [
                    "*:*"
                  ],
                  "effect": "allow",
                  "resources": [
                    "*:*"
                  ]
                }
              },
              {
                "id": 13,
                "name": "technicalPolicy",
                "policy": {
                  "actions": [
                    "agent:create"
                  ],
                  "effect": "allow",
                  "resources": [
                    "*:*:*"
                  ]
                }
              },
              {
                "id": 14,
                "name": "administratorPolicy",
                "policy": {
                  "actions": [
                    "agent:update",
                    "agent:delete"
                  ],
                  "effect": "allow",
                  "resources": [
                    "agent:id:*"
                  ]
                }
              },
              {
                "id": 17,
                "name": "policy1",
                "policy": {
                  "actions": [
                    "role:read"
                  ],
                  "effect": "deny",
                  "resources": [
                    "role:id:*"
                  ]
                }
              },
              {
                "id": 18,
                "name": "policy2",
                "policy": {
                  "actions": [
                    "role:read"
                  ],
                  "effect": "allow",
                  "resources": [
                    "role:id:1"
                  ]
                }
              },
              {
                "id": 19,
                "name": "policy3",
                "policy": {
                  "actions": [
                    "policy:read"
                  ],
                  "effect": "allow",
                  "resources": [
                    "policy:id:1"
                  ]
                }
              },
              {
                "id": 20,
                "name": "policy4",
                "policy": {
                  "actions": [
                    "policy:delete"
                  ],
                  "effect": "deny",
                  "resources": [
                    "policy:id:*"
                  ]
                }
              }
            ],
            "rule": {
              "MATCH": {
                "definition": "ossecRule"
              }
            },
            "users": [
              "normal"
            ]
          }
        ],
        "failed_items": {
          "4007": [
            "26"
          ],
          "4010": [
            "12", "16"
          ]
        }
      }
    }
  ]
}
