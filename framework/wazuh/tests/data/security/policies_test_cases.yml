---
get_policies:
- params:
    policy_ids:
    - '11'
    - '14'
  result:
    affected_items:
    - id: 11
      name: wazuhPolicy
      policy:
        actions:
        - "*:*"
        resources:
        - "*:*"
        effect: allow
      roles:
      - id: 8
        name: wazuh
        rule:
          FIND:
            r'^auth[a-zA-Z]+$':
            - administrator
      - id: 9
        name: wazuh-wui
        rule:
          FIND:
            r'^auth[a-zA-Z]+$':
            - administrator-app
      - id: 10
        name: technical
        rule:
          MATCH:
            definition: technicalRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    - id: 14
      name: administratorPolicy
      policy:
        actions:
        - agent:update
        - agent:delete
        effect: allow
        resources:
        - agent:id:*
      roles:
      - id: 11
        name: administrator_test
        rule:
          MATCH:
            definition: administratorRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    failed_items: {}
- params:
    policy_ids:
    - '13'
    - '15'
    - '16'
    - '21'
  result:
    affected_items:
    - id: 13
      name: technicalPolicy
      policy:
        actions:
        - agent:create
        effect: allow
        resources:
        - "*:*:*"
      roles:
      - id: 12
        name: normalUser
        rule:
          MATCH:
            definition: normalRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    - id: 15
      name: normalPolicy
      policy:
        actions:
        - agent:update
        - agent:delete
        effect: deny
        resources:
        - agent:id:*
      roles:
      - id: 10
        name: technical
        rule:
          MATCH:
            definition: technicalRule
      - id: 11
        name: administrator_test
        rule:
          MATCH:
            definition: administratorRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    - id: 16
      name: ossecPolicy
      policy:
        actions:
        - role:read
        effect: allow
        resources:
        - role:id:*
      roles:
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    failed_items:
      '4007':
      - '21'
- params:
    policy_ids:
    - '21'
    - '22'
    - '23'
  result:
    affected_items: []
    failed_items:
      '4007':
      - '21'
      - '22'
      - '23'
add_policy:
- params:
    name: new_policy
    policy:
      actions:
      - agent:delete
      effect: allow
      resources:
      - agent:id:099
  result:
    affected_items:
    - id: 21
      name: new_policy
      policy:
        actions:
        - agent:delete
        effect: allow
        resources:
        - agent:id:099
      roles: []
    failed_items: {}
- params:
    name: ossecPolicy
    policy:
      actions:
      - agent:delete
      effect: allow
      resources:
      - agent:id:098
  result:
    affected_items: []
    failed_items:
      '4009':
      - ossecPolicy
- params:
    name: wazuhPolicy
    policy:
      actions:
      - agent:delete
      effect: allow
      resources:
      - agent:id:097
  result:
    affected_items: []
    failed_items:
      '4009':
      - wazuhPolicy
update_policy:
- params:
    policy_id:
    - '16'
  result:
    affected_items: []
    failed_items:
      '4001':
      - '16'
- params:
    policy_id:
    - '16'
    name: ossecPolicy1
    policy:
      actions:
      - agent:delete
      effect: allow
      resources:
      - agent:id:097
  result:
    affected_items:
    - id: 16
      name: ossecPolicy1
      policy:
        actions:
        - agent:delete
        effect: allow
        resources:
        - agent:id:097
      roles:
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    failed_items: {}
- params:
    policy_id:
    - '25'
    name: normalPolicy2
    policy:
      actions:
      - agent:delete
      effect: allow
      resources:
      - agent:id:098
  result:
    affected_items: []
    failed_items:
      '4007':
      - '25'
- params:
    policy_id:
    - '14'
    name: administratorPolicy
    policy:
      actions:
      - agent:delete
      effect: allow
      resources:
      - agent:id:097
  result:
    affected_items: []
    failed_items:
      '4013':
      - '14'
- params:
    policy_id:
    - '1'
    name: wazuhPolicy
    policy:
      actions:
      - agent:delete
      effect: allow
      resources:
      - agent:id:099
  result:
    affected_items: []
    failed_items:
      '4008':
      - '1'
remove_policies:
- params:
    policy_ids:
    - '1'
    - '14'
  result:
    affected_items:
    - id: 14
      name: administratorPolicy
      policy:
        actions:
        - agent:update
        - agent:delete
        effect: allow
        resources:
        - agent:id:*
      roles:
      - id: 11
        name: administrator_test
        rule:
          MATCH:
            definition: administratorRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    failed_items:
      '4008':
      - '1'
- params:
    policy_ids:
    - '13'
    - '15'
    - '16'
    - '23'
  result:
    affected_items:
    - id: 13
      name: technicalPolicy
      policy:
        actions:
        - agent:create
        effect: allow
        resources:
        - "*:*:*"
      roles:
      - id: 12
        name: normalUser
        rule:
          MATCH:
            definition: normalRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    - id: 15
      name: normalPolicy
      policy:
        actions:
        - agent:update
        - agent:delete
        effect: deny
        resources:
        - agent:id:*
      roles:
      - id: 10
        name: technical
        rule:
          MATCH:
            definition: technicalRule
      - id: 11
        name: administrator_test
        rule:
          MATCH:
            definition: administratorRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    - id: 16
      name: ossecPolicy
      policy:
        actions:
        - role:read
        effect: allow
        resources:
        - role:id:*
      roles:
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    failed_items:
      '4007':
      - '23'
- params:
    policy_ids:
    - '20'
    - '21'
    - '22'
  result:
    affected_items:
    - id: 20
      name: policy4
      policy:
        actions:
        - policy:delete
        effect: deny
        resources:
        - policy:id:*
      roles:
      - id: 12
        name: normalUser
        rule:
          MATCH:
            definition: normalRule
      - id: 13
        name: ossec
        rule:
          MATCH:
            definition: ossecRule
    failed_items:
      '4007':
      - '21'
      - '22'
