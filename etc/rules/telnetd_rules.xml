<!-- telnetd rules for the OSSEC HIDS 
  -  Author: Ahmet Ozturk
  -  Date: Jun 02, 2006
  -->
      

<group name="telnetd,syslog">
  <rule id="3600" level="0" noalert="1">
    <match>telnetd</match>
    <description>Grouping for the telnetd rules</description>
  </rule>

  <rule id="3601" level="5">
    <if_sid>3600</if_sid>
    <match>refused connect from </match>
    <description>Connection refused by TCP Wrappers.</description>
  </rule>

  <rule id="3602" level="3">
    <if_sid>3600</if_sid>
    <match>: connect from </match>
    <description>Remote host established a telnet connection.</description>
  </rule>

  <rule id="3603" level="5" timeframe="1">
    <match>ttloop:  peer died:|ttloop:  read:</match>
    <if_matched_sid>3602</if_matched_sid>
    <description>Remote host invalid connection.</description>
  </rule>

  <rule id="3604" level="5">
    <match>warning: can't verify hostname:</match>
    <description>Reverse lookup error (bad hostname config).</description>
  </rule>

  <rule id="3631" level="10" frequency="6" timeframe="120">
    <if_matched_sid>3602</if_matched_sid>
    <same_source_ip />
    <description>Multiple connection attempts from same source </description>
    <description>(possible scan).</description>
  </rule>

</group> <!-- SYSLOG,TELNETD -->
