<!-- Official IDS rules for OSSEC
  -  Author: Daniel B. Cid
  -  Date: Jan 10, 2006
  -->

<var name="IDS_FREQ">8</var>      

<group name="ids">
  <rule id="4000" level="8">
    <category>ids</category>
    <if_fts></if_fts>
    <description>First time this IDS alert is generated.</description>
  </rule>

  <rule id="4001" level="6">
    <category>ids</category>
    <check_if_ignored>srcip, id</check_if_ignored>
    <description>IDS event.</description>
  </rule>

  <!-- This rule ignores some Ids that cause too much
    -  false positives.
    -->
  <rule id="4002" level="0">
    <if_sid>4000, 4001</if_sid>
    <!-- 1:1852 -> robots.txt access
       - 1:368 - ICMP pings.
       - 1:384 - ICMP pings.
       - 1:366 - ICMP pings.
       - 1:402 - ICMP port unreachable
       - 1:408 - ICMP reply
       - 1:1365 - RM commant attempt (too many false positives)
       -->
    <id>^1:1852:|^1:368:|^1:384:|^1:366:|^1:402:|^1:408:|^1:1365:</id>
  </rule>

  <rule id="4051" level="10" frequency="$IDS_FREQ" timeframe="120" ignore="90">
    <if_matched_sid>4001</if_matched_sid>
    <same_source_ip />
    <check_if_ignored>srcip, id</check_if_ignored>
    <description>Multiple IDS events from same source ip.</description>
  </rule>
  
  <rule id="4052" level="10" frequency="$IDS_FREQ" timeframe="120" ignore="90">
    <if_matched_sid>4001</if_matched_sid>
    <same_id />
    <check_if_ignored>id</check_if_ignored>
    <description>Multiple IDS alerts for same id.</description>
  </rule>  


  <!-- This rule is to detect bad configured IDSs alerting on
     - the same thing all the time. We will skip those events
     - since they became just noise.
     -->
  <rule id="4061" level="11" frequency="3" timeframe="3800">
    <if_matched_sid>4051</if_matched_sid>
    <same_source_ip />
    <same_id />
    <ignore>srcip, id</ignore>
    <description>Multiple IDS events from same source ip </description>
    <description>(ignoring now this srcip and id).</description>
  </rule>

  <rule id="4062" level="11" frequency="3" timeframe="3800">
    <if_matched_sid>4052</if_matched_sid>
    <same_id />
    <ignore>id</ignore>
    <description>Multiple IDS alerts for same id </description>
    <description>(ignoring now this id).</description>
  </rule>    
</group>
