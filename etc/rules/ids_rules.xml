<!-- Official IDS rules for the OSSEC HIDS
  -  Author: Daniel B. Cid
  -  Date: Jan 10, 2006
  -->

<var name="IDS_FREQ">8</var>      

<group name="ids">
  <rule id="4000" level="8">
    <category>ids</category>
    <if_fts></if_fts>
    <description>First time this IDS alert is generated.</description>
  </rule>

  <rule id="4001" level="6">
    <category>ids</category>
    <description>IDS event.</description>
  </rule>

  <rule id="4051" level="10" frequency="$IDS_FREQ" timeframe="120" ignore="90">
    <if_matched_sid>4001</if_matched_sid>
    <same_source_ip />
    <check_if_ignored>srcip, id</check_if_ignored>
    <description>Multiple IDS events from same source ip.</description>
  </rule>
  
  <rule id="4052" level="10" frequency="$IDS_FREQ" timeframe="120" ignore="90">
    <if_matched_sid>4001</if_matched_sid>
    <same_id />
    <check_if_ignored>id</check_if_ignored>
    <description>Multiple IDS alerts for same id.</description>
  </rule>  


  <!-- This rule is to detect bad configured IDSs alerting on
     - the same thing all the time. We will skip those events
     - since they became just noise.
     -->
  <rule id="4061" level="11" frequency="3" timeframe="3800">
    <if_matched_sid>4051</if_matched_sid>
    <same_source_ip />
    <same_id />
    <ignore>srcip, id</ignore>
  </rule>

  <rule id="4062" level="11" frequency="3" timeframe="3800">
    <if_matched_sid>4052</if_matched_sid>
    <same_id />
    <ignore>id</ignore>
  </rule>    
</group>
