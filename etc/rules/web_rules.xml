<!-- Apache rules.
  -  Official rules for web-logs
  -
  -  Author: Daniel B. Cid
  -  Date: Apr 30, 2006
  -->

  
<group name="web-accesslog">
  <rule id="3100" level="0">
    <decoded_as>web-accesslog</decoded_as>
    <category>web-log</category>
    <description>Access log messages grouped.</description>
  </rule>

  <rule id="3101" level="5">
    <if_sid>3100</if_sid>
    <id>^40</id>
    <description>Web server 400 error code.</description>
  </rule>

  <rule id="3102" level="6">
    <if_sid>3100</if_sid>
    
    <!-- Attempt to do directory transversal, sql injections,
      -  or access to the etc or bin directory (unix). -->
    
    <url>../../|'|%027|/etc/|/bin/|%|%00|%0A|%0D|%7f|</url>
    <url>cmd.exe|root.exe|_vti_bin|_mem_bin|msadc|/winnt/|</url>
    <url>/x90/|/xmlrpc|awstats.pl?configdir=|default.ida|</url>
    <url>/scripts/|/sumthin|nsiislog.dll|chmod%|echo%|wget%</url>
    <description>Common web attack.</description>
    <info>http://www.armbrustconsulting.com/LogEntries.html</info>
  </rule>

  <rule id="3103" level="12">
    <if_sid>3102</if_sid>
    <id>^200</id>
    <description>A commom web attack returned code 200 (success).</description>
  </rule>

  <rule id="3151" level="10" frequency="10" timeframe="120">
    <if_matched_sid>3101</if_matched_sid>
    <same_source_ip />
    <description>Mutiple web server 400 error codes </description>
    <description>from same source ip.</description>
  </rule>
  
</group> <!-- Web access log -->
