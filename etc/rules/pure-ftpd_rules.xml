<!-- Official pure-ftpd rules for the OSSEC HIDS
  -  Author: Peter Ahlert <peter@ifup.de>
  -  Author: Daniel B. Cid
  -  Date: Mar 13, 2006
  -->
      

<group name="pure-ftpd,syslog,">
  <rule id="2800" level="0" noalert="1">
    <decoded_as>pure-ftpd</decoded_as>
    <description>Grouping for the pure-ftpd rules</description>
  </rule>
  
  <rule id="2801" level="3">
    <if_sid>2800</if_sid>
    <match>[INFO] New connection from</match>
    <description>New FTP connection</description>
  </rule>

  <rule id="2802" level="5">
    <if_sid>2800</if_sid>
    <match>[WARNING] Authentication failed for user</match>
    <description>FTP Authentication failed</description>
  </rule>

  <rule id="2803" level="0">
    <if_sid>2800</if_sid>
    <match> [INFO] Logout| [INFO] Timeout</match>
    <description>FTP user logout/timeout</description>
  </rule>
  
  <rule id="2804" level="0">
    <if_sid>2800</if_sid>
    <match> [NOTICE] </match>
    <description>FTP notice messages</description>
  </rule>
  
  <rule id="2805" level="5">
    <if_sid>2800</if_sid>
    <match>[INFO] Can't change directory to</match>
    <description>Attempt to access invalid directory</match>
  </rule>  

  <rule id="1806" level="10" frequency="6" timeframe="120">
    <if_matched_sid>2802</if_matched_sid>
    <description>FTP brute force (multiple failed logins)</description>
  </rule>

  <rule id="1807" level="10" frequency="6" timeframe="60">
    <if_matched_sid>2801</if_matched_sid>
    <same_source_ip />
    <description>Multiple connection attempts from same source</description>
  </rule>
</group> <!-- SYSLOG,PURE-FTPD -->


<!-- EOF -->
