<!-- Official imapd rules for the OSSEC HIDS
  -  Author: Daniel Cid
  -  Date: Mar 19, 2006 (v0.1)
  -->

<var name="IMAPD_FREQ">6</var>      

<group name="syslog,imapd">
  <rule id="3300" level="0" noalert="1">
    <decoded_as>imapd</decoded_as>
    <description>Grouping of the imapd rules.</description>
  </rule>
  
  <rule id="3301" level="5">
    <if_sid>3300</if_sid>
    <match>Login failed user=|AUTHENTICATE LOGIN failure</match>
    <description>Imapd user login failed.</description>
  </rule>

  <rule id="3302" level="3">
    <if_sid>3300</if_sid>
    <match>Authenticated user=</match>
    <description>Imapd user login.</description>
  </rule>
  
  <rule id="3303" level="0">
    <if_sid>3300</if_sid>
    <match>Logout user=</match>
    <description>Imapd user logout.</description>
  </rule>
  
  <rule id="3351" level="10" frequency="$IMAPD_FREQ" timeframe="120">
    <if_matched_sid>3301</if_matched_sid>
    <same_source_ip />
    <description>Multiple failed logins from same source ip.</description>
  </rule>

</group> <!-- SYSLOG,IMAPD -->
