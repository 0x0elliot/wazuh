<!-- Official named rules for the OSSEC HIDS
  -  Author: Daniel B. Cid
  -  Date: Feb 28, 2006 (v0.2) - Added rule for log rotation (1904)
  -  Date: Nov 11, 2005 (v0.1)
  -->
      

<group name="syslog,named">
  <rule id="12100" level="0" noalert="1">
    <decoded_as>named</decoded_as>
    <description>Grouping of the named rules</description>
  </rule>
  
  <rule id="12101" level="12">
    <if_sid>12100</if_sid>
    <match>dropping source port zero packet from</match>
    <description>Invalid DNS packet. Possibility of attack</description>
  </rule>

  <rule id="12102" level="9">
    <if_sid>12100</if_sid>
    <match>denied AXFR from</match>
    <description>Failed attempt to perform a zone transfer</description>
  </rule>

  <rule id="12103" level="4">
    <if_sid>12100</if_sid>
    <match>denied update from|unapproved update from</match>
    <description>DNS update denied.</description>
    <description>Generally mis-configuration.</description>
    <info>http://seclists.org/lists/incidents/2000/May/0217.html</info>
  </rule>

  <rule id="12104" level="4">
    <if_sid>12100</if_sid>
    <match>unable to rename log file</match>
    <description>Log permission misconfiguration in Named</description>
  </rule>

  <rule id="12105" level="4">
    <if_sid>12100</if_sid>
    <match>unexpected RCODE </match>
    <description>Unexpected error while resolving domain</description>
  </rule>  

  <rule id="12106" level="4">
    <if_sid>12100</if_sid>
    <match>refused notify from non-master</match>
    <description>DNS configuration error.</description>
  </rule>

  <rule id="12107" level="0">
    <if_sid>12100</if_sid>
    <regex>update \S+ denied</regex>
    <description>DNS update using RFC2136 Dynamic protocol.</description>
    <info>http://www.isc.org/index.pl?/sw/bind/FAQ.php</info>
  </rule>

  <rule id="12108" level="4">
    <if_sid>12100</if_sid>
    <match>query (cache) denied</match>
    <description>Query cache denied (maybe config error).</description>
    <info>http://www.reedmedia.net/misc/dns/errors.html</info>
  </rule>
</group> <!-- SYSLOG,NAMED -->
